<style>
	html {
		float: left;
	}

	body {
		margin: 0px;
		padding: 0px;
		overflow-x: hidden;
		font-size: 12px;
		float: left;
	}
	
	#log-wrapper {
		width: 800px;
		min-height: 100px;
	}

	#log {
		padding: 10px;
	}

	code {
		color: #666666;
	}

	code em {
		color: #444444;
		font-style: normal;
		font-weight: bold;
	}

	ul {
		list-style: none;
		margin: 0;
		padding: 0;
	}

	strong, span.count {
		color: #666666;
		cursor: pointer;
		text-transform: uppercase;
		font-family: Verdana, sans-serif;
		font-weight: normal;
	}

	span.count {
		color: #ffffff;
		font-weight: bold;
		margin-left: 10px;
		padding: 0px 3px;
		background-color: #ff3333;
	}

	span.count.zero {
		background-color: #33cc33;
	}

	li.level_1 {
		border-top: 1px dotted #eeeeee;
		border-bottom: 1px dotted #eeeeee;
		padding: 5px;
	}

	ul.output {
		display: none;
		padding: 5px 2px;
	}

</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<div id="log-wrapper">
	<ul id="main-list"></ul>
</div>

<script>
	
	chrome.tabs.executeScript(null, {file:"action.js"});
	chrome.extension.onRequest.addListener(function(data, sender, resp) {
		if (data.origin == "action") {
			$.each(data, function(key, value) {
				if (key != "origin") {
					buildList(key, value);
				}
			});
		} else {
			console.log(data);
		}
	});

	function buildList(listName, listValues) {
		var dom = 'Good job!';
		if (listValues.length > 0) {
			dom = '<li class="level_1"><strong>' + listName + '</strong>';
			dom += '<span id="' + listName + '-count" class="count">' + listValues.length + '</span>';
			dom += '<ul id="' + listName + '-output" class="output">';

				for (var i = 0; i < listValues.length; i++) {
					dom += '<li><code style="display: block"><em>[' + listValues[i][0] + ']</em> ';
						dom += listValues[i][1].replace(/</g, "&lt;").replace(/>/g, "&gt;");
						dom += '</code></li>';
				}
				dom += '</ul></li>';
		}

		$("#main-list").append(dom);
	}

</script>

<script>

(function() {
	$(document).ready(function() {
		$("#main-list").on("click", "strong, span.count", function() {
			$(this).parent().children("ul").slideToggle();
		});
	});
})(jQuery)

</script>

